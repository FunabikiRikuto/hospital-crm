# Hospital CRM - 機能仕様書

**プロジェクト**: 医療ツーリズム向けCRMシステム  
**作成日**: 2025年7月29日  
**バージョン**: v1.0  

---

## 1. システム概要

### 目的
医療ツーリズム事業における患者管理、診療記録、予約管理を効率化するCRMシステム

### 対象ユーザー
- **医師**: 診療記録作成・患者情報確認
- **看護師**: 患者ケア記録・スケジュール管理
- **事務スタッフ**: 予約管理・患者登録・請求処理
- **管理者**: システム設定・レポート確認

---

## 2. 主要機能一覧

### 2.1 認証・権限管理
- ログイン・ログアウト
- ロールベースアクセス制御（医師・看護師・事務・管理者）
- パスワード変更・リセット
- セッション管理

### 2.2 患者管理
- 患者登録・編集・削除
- 患者検索・フィルタリング
- 患者詳細情報表示
- 患者履歴管理

### 2.3 診療記録管理
- 診療記録作成・編集
- 診断・治療内容記録
- 処方薬管理
- 検査結果記録

### 2.4 予約管理
- 予約作成・変更・キャンセル
- 予約カレンダー表示
- 時間枠管理
- 予約確認・通知

### 2.5 ダッシュボード・レポート
- 主要指標表示
- 患者統計
- 診療実績
- 売上分析

---

## 3. 画面・機能詳細仕様

### 3.1 ログイン画面

#### 画面レイアウト
```
┌─────────────────────────────────┐
│          Hospital CRM           │
│                                 │
│  ┌─────────────────────────┐    │
│  │     Email Address       │    │
│  └─────────────────────────┘    │
│                                 │
│  ┌─────────────────────────┐    │
│  │       Password          │    │
│  └─────────────────────────┘    │
│                                 │
│  ☐ Remember me                  │
│                                 │
│  [      ログイン      ]          │
│                                 │
│  パスワードを忘れた方はこちら        │
└─────────────────────────────────┘
```

#### 機能要件
- **必須項目**: メールアドレス、パスワード
- **バリデーション**: メール形式チェック、パスワード最小8文字
- **認証**: JWT トークン発行
- **エラーハンドリング**: 認証失敗時のメッセージ表示
- **セキュリティ**: ログイン試行制限（5回まで）

#### 受け入れ条件
- [ ] 正しい認証情報でログインできる
- [ ] 間違った認証情報でエラーメッセージが表示される
- [ ] Remember me チェックで次回自動ログイン
- [ ] パスワードリセットリンクが機能する

---

### 3.2 ダッシュボード画面

#### 画面レイアウト
```
┌──────────┬─────────────────────────────────────┐
│          │  Hospital CRM Dashboard             │
│ サイドバー │                                     │
│          │  ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐  │
│ - ダッシュ │  │患者数│ │診療数│ │売上  │ │満足度│  │
│ - 患者管理 │  │1,234│ │  89 │ │12.5M│ │ 94% │  │
│ - 診療記録 │  └─────┘ └─────┘ └─────┘ └─────┘  │
│ - 予約管理 │                                     │
│ - レポート │  ┌─────────────┐ ┌─────────────┐  │  
│ - 設定    │  │   最近の活動    │ │ 今週のタスク   │  │
│          │  │               │ │               │  │
│          │  │ ・新規患者登録   │ │ ☐ フォローアップ │  │
│          │  │ ・診療記録更新   │ │ ☑ レポート作成  │  │
│          │  │ ・予約確認完了   │ │ ☐ 新規企画    │  │
│          │  └─────────────┘ └─────────────┘  │
└──────────┴─────────────────────────────────────┘
```

#### 機能要件
- **KPI表示**: 総患者数、今月の診療件数、売上、患者満足度
- **活動履歴**: 最近の患者登録・診療記録更新等
- **タスク管理**: チェックボックス付きタスクリスト
- **リアルタイム更新**: データの自動更新
- **権限制御**: ユーザーロールによる表示内容変更

#### 受け入れ条件
- [ ] KPI指標が正しく表示される
- [ ] 活動履歴が時系列で表示される
- [ ] タスクの完了・未完了を切り替えできる
- [ ] ユーザーロールに応じた表示制御

---

### 3.3 患者管理画面

#### 患者一覧画面
```
┌─────────────────────────────────────────────────┐
│ 患者管理                            [+ 新規登録] │
│                                                 │
│ 🔍 [検索ボックス] [フィルター▼] [エクスポート▼]  │
│                                                 │
│ ┌─────────────────────────────────────────────┐ │
│ │ ID   │ 患者名    │ 年齢 │ 性別 │ 最終診療日  │  │
│ ├─────────────────────────────────────────────┤ │
│ │ 0001 │ 山田 ◯◯  │ 45  │ 男  │ 2025/07/25 │  │
│ │ 0002 │ 佐藤 △△  │ 38  │ 女  │ 2025/07/23 │  │
│ │ 0003 │ 田中 □□  │ 52  │ 男  │ 2025/07/20 │  │
│ └─────────────────────────────────────────────┘ │
│                                                 │
│ 表示件数: 25件 / 全1,234件           [1][2][3]▶ │
└─────────────────────────────────────────────────┘
```

#### 機能要件
- **患者検索**: 名前・ID・電話番号による検索
- **フィルタリング**: 年齢・性別・診療科・ステータス
- **ソート**: 各列でのソート機能
- **ページネーション**: 25件/50件/100件表示切り替え
- **患者詳細**: 行クリックで詳細画面遷移
- **一括操作**: 複数選択でのエクスポート
- **プライバシー**: 患者名の部分マスク表示

#### 受け入れ条件
- [ ] 検索・フィルタ機能が正常動作する
- [ ] ページネーションが正しく機能する
- [ ] 患者詳細画面に遷移できる
- [ ] プライバシー保護が適用されている

---

### 3.4 患者詳細・登録画面

#### 画面レイアウト
```
┌─────────────────────────────────────────────────┐
│ 患者詳細 - 山田太郎 (ID: 0001)      [編集][削除] │
│                                                 │
│ ┌─基本情報─────────────────────────────────────┐ │
│ │ 氏名: 山田太郎        生年月日: 1980/03/15    │ │
│ │ フリガナ: ヤマダタロウ   年齢: 45歳           │ │
│ │ 性別: 男性            国籍: 日本             │ │
│ │ 電話: 090-1234-5678   メール: yamada@xxx.com │ │
│ │ 住所: 東京都渋谷区...                        │ │
│ └─────────────────────────────────────────────┘ │
│                                                 │
│ ┌─診療履歴─────────────────────────────────────┐ │
│ │ 2025/07/25 │ 内科   │ 定期健診     │ 田中医師  │ │
│ │ 2025/06/20 │ 内科   │ 血圧測定     │ 田中医師  │ │
│ │ 2025/05/15 │ 整形外科│ 腰痛相談     │ 佐藤医師  │ │
│ └─────────────────────────────────────────────┘ │
│                                                 │
│ ┌─予約情報─────────────────────────────────────┐ │
│ │ 次回予約: 2025/08/15 14:00 - 内科定期健診     │ │
│ └─────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────┘
```

#### 機能要件
- **基本情報表示**: 氏名・連絡先・住所等
- **診療履歴**: 過去の診療記録一覧
- **予約情報**: 今後の予約予定
- **編集機能**: 患者情報の更新
- **削除機能**: 患者データの論理削除（管理者のみ）
- **履歴追跡**: データ変更履歴の記録

#### 受け入れ条件
- [ ] 患者の全情報が正しく表示される
- [ ] 診療履歴が時系列で表示される
- [ ] 編集権限がロールに応じて制御される
- [ ] データ変更時に履歴が記録される

---

### 3.5 診療記録画面

#### 診療記録作成画面
```
┌─────────────────────────────────────────────────┐
│ 診療記録作成 - 山田太郎 (ID: 0001)              │
│                                                 │
│ 診療日時: [2025/07/29 14:30] 担当医師: [田中医師]│
│                                                 │
│ ┌─主訴─────────────────────────────────────────┐ │
│ │ [腰痛が続いている。特に朝起きた時に痛む。]       │ │
│ └─────────────────────────────────────────────┘ │
│                                                 │
│ ┌─現病歴───────────────────────────────────────┐ │
│ │ [約2週間前から腰痛が始まり、特に起床時に...]    │ │
│ └─────────────────────────────────────────────┘ │
│                                                 │
│ ┌─診断─────────────────────────────────────────┐ │
│ │ [急性腰痛症 (M54.5)]                         │ │
│ └─────────────────────────────────────────────┘ │
│                                                 │
│ ┌─治療・処方────────────────────────────────────┐ │
│ │ 処方薬: [ロキソニン 60mg] 用法: [1日3回食後]   │ │
│ │ 治療: [物理療法、安静指導]                     │ │
│ └─────────────────────────────────────────────┘ │
│                                                 │
│ [保存] [一時保存] [キャンセル]                   │
└─────────────────────────────────────────────────┘
```

#### 機能要件
- **テンプレート**: 診療科別の記録テンプレート
- **薬剤検索**: 処方薬の検索・選択機能
- **自動保存**: 定期的な一時保存
- **承認フロー**: 医師による最終承認
- **印刷機能**: 診療記録の印刷・PDF出力
- **検索**: 過去の診療記録からのコピー機能

#### 受け入れ条件
- [ ] テンプレートが正しく適用される
- [ ] 薬剤検索・選択が機能する
- [ ] 自動保存が定期実行される
- [ ] 承認フローが適切に動作する

---

### 3.6 予約管理画面

#### 予約カレンダー画面
```
┌─────────────────────────────────────────────────┐
│ 予約管理                    [◀ 2025年7月 ▶]     │
│                                                 │
│     月   火   水   木   金   土   日             │
│ ┌─────┬─────┬─────┬─────┬─────┬─────┬─────┐ │
│ │  1  │  2  │  3  │  4  │  5  │  6  │  7  │ │
│ ├─────┼─────┼─────┼─────┼─────┼─────┼─────┤ │
│ │  8  │  9  │ 10  │ 11  │ 12  │ 13  │ 14  │ │
│ ├─────┼─────┼─────┼─────┼─────┼─────┼─────┤ │
│ │ 15  │ 16  │ 17  │ 18  │ 19  │ 20  │ 21  │ │
│ ├─────┼─────┼─────┼─────┼─────┼─────┼─────┤ │
│ │ 22  │ 23  │ 24  │ 25  │ 26  │ 27  │ 28  │ │
│ │     │     │     │ 🟢  │     │     │     │ │
│ │     │     │     │10:00│     │     │     │ │
│ │     │     │     │山田 │     │     │     │ │
│ ├─────┼─────┼─────┼─────┼─────┼─────┼─────┤ │
│ │ 29  │ 30  │ 31  │     │     │     │     │ │
│ │ 🔵  │     │     │     │     │     │     │ │
│ │14:00│     │     │     │     │     │     │ │
│ │田中 │     │     │     │     │     │     │ │
│ └─────┴─────┴─────┴─────┴─────┴─────┴─────┘ │
└─────────────────────────────────────────────────┘
```

#### 機能要件
- **カレンダー表示**: 月・週・日表示切り替え
- **予約作成**: ドラッグ&ドロップでの予約作成
- **予約変更**: 既存予約の時間変更・キャンセル
- **患者検索**: 予約時の患者検索・選択
- **時間枠管理**: 診療科別の利用可能時間設定
- **衝突検知**: ダブルブッキング防止
- **通知**: 予約確認・リマインダー送信

#### 受け入れ条件
- [ ] カレンダー表示が正しく機能する
- [ ] 予約の作成・変更・削除ができる
- [ ] ダブルブッキングが防止される
- [ ] 予約通知が適切に送信される

---

## 4. ユーザーストーリー

### US-001: 患者登録
**As a** 事務スタッフ  
**I want to** 新規患者の基本情報を登録する  
**So that** 診療記録や予約管理ができる  

**受け入れ条件:**
- 必須項目（氏名・生年月日・連絡先）を入力できる
- バリデーションエラーが適切に表示される
- 登録完了後に患者IDが発行される

### US-002: 診療記録作成
**As a** 医師  
**I want to** 患者の診療内容を記録する  
**So that** 継続的な治療と情報共有ができる  

**受け入れ条件:**
- テンプレートを使用して効率的に記録できる
- 薬剤情報を検索・選択できる
- 記録の承認・確定ができる

### US-003: 予約管理
**As a** 看護師  
**I want to** 患者の予約を管理する  
**So that** スムーズな診療が行える  

**受け入れ条件:**
- カレンダー上で予約の作成・変更ができる
- ダブルブッキングが防止される
- 患者への確認通知が送信される

---

## 5. 非機能要件

### パフォーマンス
- ページ読み込み時間: 3秒以内
- API レスポンス時間: 500ms以内
- 同時接続ユーザー数: 100名まで

### セキュリティ
- HTTPS通信必須
- JWT認証によるセッション管理
- 患者情報の暗号化保存
- 監査ログの記録

### 可用性
- システム稼働率: 99.5%以上
- 自動バックアップ: 日次実行
- 障害復旧時間: 4時間以内

---

## 6. テストシナリオ

### 機能テスト
1. **ログイン機能テスト**
   - 正常ログイン
   - 認証失敗処理
   - セッション管理

2. **患者管理テスト**
   - 患者登録・編集・削除
   - 検索・フィルタリング
   - データ整合性

3. **診療記録テスト**
   - 記録作成・承認フロー
   - テンプレート機能
   - 薬剤検索

4. **予約管理テスト**
   - 予約作成・変更・キャンセル
   - カレンダー表示
   - 衝突検知

### 統合テスト
- ユーザーロール別アクセス制御
- データ連携（患者↔診療記録↔予約）
- 外部システム連携

### E2Eテスト
- 患者登録→診療記録作成→次回予約のフル業務フロー
- 複数ユーザーでの同時操作
- データ整合性の確認

---

**この機能仕様書は実装チームの開発指針となります。各機能の詳細な画面遷移図・UI仕様は別途デザインシステムと合わせて参照してください。**